// apps/api-server/src/config/feature-flags.ts
import { Unleash } from 'unleash-client';

export const featureFlags = new Unleash({
  url: process.env.UNLEASH_URL!,
  appName: 'rummikub-api',
  customHeaders: {
    Authorization: process.env.UNLEASH_API_KEY!,
  },
});

export const Features = {
  CRYPTO_PAYMENTS: 'crypto-payments',
  NEW_MATCHMAKING: 'new-matchmaking-algorithm',
  TOURNAMENT_V2: 'tournament-v2',
  AI_EXPERT_MODE: 'ai-expert-mode',
  SEASONAL_EVENTS: 'seasonal-events',
  NFT_MARKETPLACE: 'nft-marketplace',
} as const;

// Usage in code
export function isFeatureEnabled(feature: keyof typeof Features, userId?: string): boolean {
  return featureFlags.isEnabled(Features[feature], {
    userId,
    properties: {
      environment: process.env.NODE_ENV,
    },
  });
}